<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>A Better Way to Override References With PackageReference -- Duane Newman</title>

    

    
    <link href="https://duanenewman.net/css/bootstrap.min.css" rel="stylesheet">

    
    <link href="https://duanenewman.net/css/clean-blog.min.css" rel="stylesheet">

	
    <link href="https://duanenewman.net/css/prism.css" rel="stylesheet">

    
    <link href="https://duanenewman.net/css/custom.css" rel="stylesheet">

    
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    
    
    

</head>

<body>

    
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://duanenewman.net">Duane Newman</a>
            </div>

                       
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    
                    <li>
                        <a href="https://duanenewman.net/">Home</a>
                    </li>
					
                    <li>
                        <a href="https://duanenewman.net/blog/">Blog</a>
                    </li>
					
                    <li>
                        <a href="https://duanenewman.net/appearances/">Appearances</a>
                    </li>
					
                    <li>
                        <a href="https://duanenewman.net/speaking/">Speaking</a>
                    </li>
					
                    <li>
                        <a href="https://duanenewman.net/about/">About</a>
                    </li>
					
                  </ul>
            </div>
           

        </div>
        
    </nav>


    
    
    <header class="intro-header" style="background-image: url('https://duanenewman.net/img/post-bg.jpg')">
    
      <div class="container">
        <div class="row">
           <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
             <div class="post-heading">
               <h1>A Better Way to Override References With PackageReference</h1>
               <h2 class="subheading"></h2>
               <span class="meta">
                 
  A 1 minute read,

Posted on Mon, Apr 1, 2019 In <a href="https://duanenewman.net/categories/coding">Coding</a>

<br />
Tags <a href="https://duanenewman.net/tags/csharp">csharp</a>, <a href="https://duanenewman.net/tags/dotnet">dotnet</a>

               </span>
             </div>
           </div>
        </div>
      </div>
    </header>

    
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  <p>Recently, there was a <a href="https://github.com/NuGet/Home/issues/6949" target="_blank">new feature added</a> to msbuild (working in Visual Studio 2019 15.9.9) that generates a variable for each package that contains the full path to the package version being used. All you have to do is add an attribute to each <code>&lt;PackageReference&gt;</code> you want need to work with.</p>

<p>There are just two changes to what we did before:</p>

<ol>
<li>Add <code>GeneratePathProperty</code> attribute to <code>&lt;PackageReference&gt;</code></li>
<li>Switch to <code>Pkg&lt;Package_Name&gt;</code> variable in <code>&lt;HintPath&gt;</code></li>
</ol>

<p>Step one is pretty simple, add the attribute <code>GeneratePathProperty</code> with a value of <code>true</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;PackageReference</span> <span style="color:#a6e22e">Include=</span><span style="color:#e6db74">&#34;Prism.Core&#34;</span> <span style="color:#a6e22e">GeneratePathProperty=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;Version&gt;</span>7.1.0.431<span style="color:#f92672">&lt;/Version&gt;</span>
<span style="color:#f92672">&lt;/PackageReference&gt;</span></code></pre></div>
<p>This will cause msbuild to generate a property for that package that points to directory for the specific version of that package, future proofing against version changes and any changes in directory structure to how NuGet stores the package cache. The variable format prepends <code>Pkg</code> to the package name and replaced any period (.) with an underscore (_). That makes the variable for <code>Prism.Core</code> into <code>PkgPrism_Core</code>.</p>

<p>That makes the next step pretty easy. Let&rsquo;s update our <code>&lt;Reference&gt;</code> to this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;Reference</span> <span style="color:#a6e22e">Include=</span><span style="color:#e6db74">&#34;Prism&#34;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;HintPath&gt;</span>$(PkgPrism_Core)lib\netstandard2.0\Prism.dll<span style="color:#f92672">&lt;/HintPath&gt;</span>
<span style="color:#f92672">&lt;/Reference&gt;</span></code></pre></div>
<p>Now when you update packages to a new version you no longer need to worry about updating the <code>&lt;Reference&gt;</code> element.</p>

                  <div style="clear:both"></div>


   <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "duanenewmannet" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


                </div>
            </div>
        </div>
    </article>

    <hr>
    
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  <ul class="list-inline text-center">
                    
                    
                    <li>
                      <a href="https://twitter.com/duanenewman">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://github.com/duanenewman">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://www.instagram.com/duanenewman">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="http://youtube.com/dnewman31">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://www.flickr.com/duane_newman/">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-flickr fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://www.kickstarter.com/profile/duanenewman">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-usd fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                  </ul>
                  <p class="copyright text-muted">Copyright Duane Newman</p>
                </div>
            </div>
        </div>
    </footer>

    
    <script src="https://duanenewman.net/js/jquery.min.js"></script>

    
    <script src="https://duanenewman.net/js/bootstrap.min.js"></script>

    
    <script src="https://duanenewman.net/js/prism.js"></script>

    
    <script src="https://duanenewman.net/js/clean-blog.js"></script>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-2838107-3', 'auto');
	
	ga('send', 'pageview');
}
</script>


</body>

</html>

